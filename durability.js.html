<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>durability.js - Oracle NoSQL Database Node.js SDK</title>
    
    
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="wrap">
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-connect-cloud.html">Connecting an Application to Oracle NoSQL Database Cloud Service</a></li><li><a href="tutorial-connect-on-prem.html">Connecting an Application to On-Premise Oracle NoSQL Database</a></li><li><a href="tutorial-tables.html">Working With Tables</a></li></ul><h3>Classes</h3><ul><li><a href="AdminState.html">AdminState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AdminState.html#toString">toString</a></li></ul></li><li><a href="CapacityMode.html">CapacityMode</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CapacityMode.html#toString">toString</a></li></ul></li><li><a href="Consistency.html">Consistency</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Consistency.html#toString">toString</a></li></ul></li><li><a href="Durabilities.html">Durabilities</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Durabilities.html#.create">create</a></li></ul></li><li><a href="Enum.html">Enum</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Enum.html#toString">toString</a></li></ul></li><li><a href="ErrorCode.html">ErrorCode</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ErrorCode.html#toString">toString</a></li></ul></li><li><a href="NoSQLArgumentError.html">NoSQLArgumentError</a></li><li><a href="NoSQLAuthorizationError.html">NoSQLAuthorizationError</a></li><li><a href="NoSQLClient.html">NoSQLClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="NoSQLClient.html#adminDDL">adminDDL</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#adminStatus">adminStatus</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#close">close</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#deleteIfVersion">deleteIfVersion</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#deleteRange">deleteRange</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#forCompletion">forCompletion</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#forTableState">forTableState</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#get">get</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#getIndex">getIndex</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#getIndexes">getIndexes</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#getSerialVersion">getSerialVersion</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#getTable">getTable</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#getTableUsage">getTableUsage</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#listNamespaces">listNamespaces</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#listRoles">listRoles</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#listTables">listTables</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#listUsers">listUsers</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#precacheAuth">precacheAuth</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#put">put</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#putIfAbsent">putIfAbsent</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#putIfPresent">putIfPresent</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#putIfVersion">putIfVersion</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#putMany">putMany</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#query">query</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#queryIterable">queryIterable</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#setTableLimits">setTableLimits</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#setTableTags">setTableTags</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#tableDDL">tableDDL</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#tableUsageIterable">tableUsageIterable</a></li><li data-type='method' style='display: none;'><a href="NoSQLClient.html#writeMany">writeMany</a></li></ul></li><li><a href="NoSQLError.html">NoSQLError</a></li><li><a href="NoSQLNetworkError.html">NoSQLNetworkError</a></li><li><a href="NoSQLProtocolError.html">NoSQLProtocolError</a></li><li><a href="NoSQLQueryError.html">NoSQLQueryError</a></li><li><a href="NoSQLServiceError.html">NoSQLServiceError</a></li><li><a href="NoSQLTimeoutError.html">NoSQLTimeoutError</a></li><li><a href="NoSQLUnsupportedProtocolError.html">NoSQLUnsupportedProtocolError</a></li><li><a href="PreparedStatement.html">PreparedStatement</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PreparedStatement.html#clearAll">clearAll</a></li><li data-type='method' style='display: none;'><a href="PreparedStatement.html#copyStatement">copyStatement</a></li><li data-type='method' style='display: none;'><a href="PreparedStatement.html#set">set</a></li></ul></li><li><a href="Region.html">Region</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Region.html#toString">toString</a></li></ul></li><li><a href="ReplicaAckPolicy.html">ReplicaAckPolicy</a></li><li><a href="ServiceType.html">ServiceType</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ServiceType.html#toString">toString</a></li></ul></li><li><a href="SimpleRateLimiter.html">SimpleRateLimiter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SimpleRateLimiter.html#consumeUnits">consumeUnits</a></li><li data-type='method' style='display: none;'><a href="SimpleRateLimiter.html#onThrottle">onThrottle</a></li><li data-type='method' style='display: none;'><a href="SimpleRateLimiter.html#setLimit">setLimit</a></li></ul></li><li><a href="SyncPolicy.html">SyncPolicy</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SyncPolicy.html#toString">toString</a></li></ul></li><li><a href="TableState.html">TableState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="TableState.html#toString">toString</a></li></ul></li><li><a href="TTLUtil.html">TTLUtil</a><ul class='methods'><li data-type='method' style='display: none;'><a href="TTLUtil.html#.fromExpirationTime">fromExpirationTime</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.ofDays">ofDays</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.ofHours">ofHours</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.toDays">toDays</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.toExpirationTime">toExpirationTime</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.toExpirationTimeMillis">toExpirationTimeMillis</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.toHours">toHours</a></li><li data-type='method' style='display: none;'><a href="TTLUtil.html#.toMillis">toMillis</a></li></ul></li></ul><h3>Interfaces</h3><ul><li><a href="RateLimiter.html">RateLimiter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RateLimiter.html#consumeUnits">consumeUnits</a></li><li data-type='method' style='display: none;'><a href="RateLimiter.html#onThrottle">onThrottle</a></li><li data-type='method' style='display: none;'><a href="RateLimiter.html#setLimit">setLimit</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="NoSQLClient.html#event:consumedCapacity">consumedCapacity</a></li><li><a href="NoSQLClient.html#event:error">error</a></li><li><a href="NoSQLClient.html#event:retryable">retryable</a></li><li><a href="NoSQLClient.html#event:tableState">tableState</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AdminResult">AdminResult</a></li><li><a href="global.html#AuthConfig">AuthConfig</a></li><li><a href="global.html#AuthorizationProvider">AuthorizationProvider</a></li><li><a href="global.html#Config">Config</a></li><li><a href="global.html#ConsumedCapacity">ConsumedCapacity</a></li><li><a href="global.html#ContinuationKey">ContinuationKey</a></li><li><a href="global.html#DBNumberConfig">DBNumberConfig</a></li><li><a href="global.html#DefinedTags">DefinedTags</a></li><li><a href="global.html#delay">delay</a></li><li><a href="global.html#DelegationTokenProvider">DelegationTokenProvider</a></li><li><a href="global.html#DeleteResult">DeleteResult</a></li><li><a href="global.html#doRetry">doRetry</a></li><li><a href="global.html#Durability">Durability</a></li><li><a href="global.html#FieldRange">FieldRange</a></li><li><a href="global.html#FieldValue">FieldValue</a></li><li><a href="global.html#FreeFormTags">FreeFormTags</a></li><li><a href="global.html#getAuthorization">getAuthorization</a></li><li><a href="global.html#GetResult">GetResult</a></li><li><a href="global.html#IAMConfig">IAMConfig</a></li><li><a href="global.html#IAMCredentials">IAMCredentials</a></li><li><a href="global.html#IAMCredentialsProvider">IAMCredentialsProvider</a></li><li><a href="global.html#IndexInfo">IndexInfo</a></li><li><a href="global.html#Key">Key</a></li><li><a href="global.html#KVStoreAuthConfig">KVStoreAuthConfig</a></li><li><a href="global.html#KVStoreCredentials">KVStoreCredentials</a></li><li><a href="global.html#KVStoreCredentialsProvider">KVStoreCredentialsProvider</a></li><li><a href="global.html#ListTablesResult">ListTablesResult</a></li><li><a href="global.html#loadDelegationToken">loadDelegationToken</a></li><li><a href="global.html#loadIAMCredentials">loadIAMCredentials</a></li><li><a href="global.html#loadKVStoreCredentials">loadKVStoreCredentials</a></li><li><a href="global.html#MultiDeleteResult">MultiDeleteResult</a></li><li><a href="global.html#NumberLibConfig">NumberLibConfig</a></li><li><a href="global.html#NumberLibMethods">NumberLibMethods</a></li><li><a href="global.html#NumberLibPrecision">NumberLibPrecision</a></li><li><a href="global.html#NumberLibRoundingMode">NumberLibRoundingMode</a></li><li><a href="global.html#Operation">Operation</a></li><li><a href="global.html#PrepareResult">PrepareResult</a></li><li><a href="global.html#PutResult">PutResult</a></li><li><a href="global.html#QueryResult">QueryResult</a></li><li><a href="global.html#RetryConfig">RetryConfig</a></li><li><a href="global.html#RetryHandler">RetryHandler</a></li><li><a href="global.html#RoundingModesMap">RoundingModesMap</a></li><li><a href="global.html#Row">Row</a></li><li><a href="global.html#TableETag">TableETag</a></li><li><a href="global.html#TableLimits">TableLimits</a></li><li><a href="global.html#TableResult">TableResult</a></li><li><a href="global.html#TableUsage">TableUsage</a></li><li><a href="global.html#TableUsageResult">TableUsageResult</a></li><li><a href="global.html#TimeToLive">TimeToLive</a></li><li><a href="global.html#UserInfo">UserInfo</a></li><li><a href="global.html#Version">Version</a></li><li><a href="global.html#WriteMultipleResult">WriteMultipleResult</a></li><li><a href="global.html#WriteOperation">WriteOperation</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">durability.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*-
 * Copyright (c) 2018, 2023 Oracle and/or its affiliates. All rights reserved.
 *
 * Licensed under the Universal Permissive License v 1.0 as shown at
 *  https://oss.oracle.com/licenses/upl/
 */

'use strict';

const Enum = require('./constants').Enum;
const NoSQLArgumentError = require('./error').NoSQLArgumentError;

/**
 * On premise only: see {@link Durability}
 * Defines the synchronization policy to be used when committing a
 * transaction. High levels of synchronization offer a greater guarantee
 * that the transaction is persistent to disk, but trade that off for
 * lower performance.
 * @extends Enum
 * @hideconstructor
 */
class SyncPolicy extends Enum {}

/**
 * Write and synchronously flush the log on transaction commit.
 * Transactions exhibit all the ACID (atomicity, consistency,
 * isolation, and durability) properties.
 * @type {SyncPolicy}
 * @since 5.3.0
 */
SyncPolicy.SYNC = new SyncPolicy(1);

/**
 * Do not write or synchronously flush the log on transaction commit.
 * Transactions exhibit the ACI (atomicity, consistency, and isolation)
 * properties, but not D (durability); that is, database integrity will
 * be maintained, but if the application or system fails, it is
 * possible some number of the most recently committed transactions may
 * be undone during recovery. The number of transactions at risk is
 * governed by how many log updates can fit into the log buffer, how
 * often the operating system flushes dirty buffers to disk, and how
 * often log checkpoints occur.
 * @type {SyncPolicy}
 * @since 5.3.0
 */
SyncPolicy.NO_SYNC = new SyncPolicy(2);

/**
 * Write but do not synchronously flush the log on transaction commit.
 * Transactions exhibit the ACI (atomicity, consistency, and isolation)
 * properties, but not D (durability); that is, database integrity will
 * be maintained, but if the operating system fails, it is possible
 * some number of the most recently committed transactions may be
 * undone during recovery. The number of transactions at risk is
 * governed by how often the operating system flushes dirty buffers to
 * disk, and how often log checkpoints occur.
 * @type {SyncPolicy}
 * @since 5.3.0
 */
SyncPolicy.WRITE_NO_SYNC = new SyncPolicy(3);

SyncPolicy.seal();

/**
 * On premise only: see {@link Durability}
 * A replicated environment makes it possible to increase an application's
 * transaction commit guarantees by committing changes to its replicas on
 * the network. ReplicaAckPolicy defines the policy for how such network
 * commits are handled.
 * @hideconstructor
 */
class ReplicaAckPolicy extends Enum {}

/**
 * All replicas must acknowledge that they have committed the
 * transaction. This policy should be selected only if your replication
 * group has a small number of replicas, and those replicas are on
 * extremely reliable networks and servers.
 * @type {ReplicaAckPolicy}
 * @since 5.3.0
 */
ReplicaAckPolicy.ALL = new ReplicaAckPolicy(1);

/**
 * No transaction commit acknowledgments are required and the master
 * will never wait for replica acknowledgments. In this case,
 * transaction durability is determined entirely by the type of commit
 * that is being performed on the master.
 * @type {ReplicaAckPolicy}
 * @since 5.3.0
 */
ReplicaAckPolicy.NONE = new ReplicaAckPolicy(2);

/**
 * A simple majority of replicas must acknowledge that they have
 * committed the transaction. This acknowledgment policy, in
 * conjunction with an election policy which requires at least a simple
 * majority, ensures that the changes made by the transaction remains
 * durable if a new election is held.
 * @type {ReplicaAckPolicy}
 * @since 5.3.0
 */
ReplicaAckPolicy.SIMPLE_MAJORITY = new ReplicaAckPolicy(3);

ReplicaAckPolicy.seal();

/**
 * @classdesc
 * On-premises service only.
 * Helper class that defines some useful {@link Durability} constants as well
 * as a method to create {@link Durability} instances. Note that durability
 * instance is a plain JavaScript object as described in {@link Durability}.
 * @hideconstructor
 * @see Durability
 */
class Durabilities {
    
    /**
     * A convenience constant that defines a durability policy with COMMIT_SYNC
     * for Master commit synchronization.
     * &lt;p>
     * The policies default to COMMIT_NO_SYNC for commits of replicated
     * transactions that need acknowledgment and SIMPLE_MAJORITY for the
     * acknowledgment policy.
     * @type {Durability}
     */
    static COMMIT_SYNC = this.create(SyncPolicy.SYNC,
        SyncPolicy.NO_SYNC, ReplicaAckPolicy.SIMPLE_MAJORITY);
 
    /**
     * A convenience constant that defines a durability policy with
     * COMMIT_NO_SYNC for Master commit synchronization.
     * &lt;p>
     * The policies default to COMMIT_NO_SYNC for commits of replicated
     * transactions that need acknowledgment and SIMPLE_MAJORITY for the
     * acknowledgment policy.
     * @type {Durability}
     */
    static COMMIT_NO_SYNC = this.create(SyncPolicy.NO_SYNC,
        SyncPolicy.NO_SYNC, ReplicaAckPolicy.SIMPLE_MAJORITY);
 
    /**
     * A convenience constant that defines a durability policy with
     * COMMIT_WRITE_NO_SYNC for Master commit synchronization.
     * &lt;p>
     * The policies default to COMMIT_NO_SYNC for commits of replicated
     * transactions that need acknowledgment and SIMPLE_MAJORITY for the
     * acknowledgment policy.
     * @type {Durability}
     */
    static COMMIT_WRITE_NO_SYNC = this.create(SyncPolicy.WRITE_NO_SYNC,
        SyncPolicy.NO_SYNC, ReplicaAckPolicy.SIMPLE_MAJORITY);
 
    /**
     * Creates a {@link Durability} instance while validating the arguments
     * passed.
     * 
     * @param {SyncPolicy} masterSync Sync policy when committing transaction
     * on the master node 
     * @param {SyncPolicy} replicaSync Sync policy when committing transaction
     * at a replica node
     * @param {ReplicaAckPolicy} replicaAck The acknowledgment policy used
     * when obtaining transaction acknowledgments from replicas
     * @returns {Durability} Durability object
     * @throws {NoSQLArgumentError} If any of the provided values for
     * &lt;em>masterSync&lt;/em>, &lt;em>replicaSync&lt;/em> or &lt;em>replicaAck&lt;/em> is
     * missing or invalid.
     */
    static create(masterSync, replicaSync, replicaAck) {
        if (!(masterSync instanceof SyncPolicy)) {
            throw new NoSQLArgumentError(
                'Missing or invalid masterSync policy');
        }
        if (!(replicaSync instanceof SyncPolicy)) {
            throw new NoSQLArgumentError(
                'Missing or invalid replicaSync policy');
        }
        if (!(replicaAck instanceof ReplicaAckPolicy)) {
            throw new NoSQLArgumentError(
                'Missing or invalid replicaAck policy');
        }
        return {
            masterSync,
            replicaSync,
            replicaAck
        };
    }
}

module.exports = {
    SyncPolicy,
    ReplicaAckPolicy,
    Durabilities
};
</code></pre>
        </article>
    </section>





    
</div>

<br class="clear">

<footer>
Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
